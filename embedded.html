<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>UCPM ‚Äì Embedded Form</title>
  <style>
    :root { font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif; }
    body { margin:0; background:#f6f7f9; }
    .wrap { max-width:980px; margin:0 auto; padding:24px; }
    .card { background:#fff; border-radius:14px; padding:18px; margin:14px 0; box-shadow:0 2px 10px rgba(0,0,0,.06); }
    .back-btn {
      display:inline-flex; align-items:center; gap:8px;
      padding:8px 14px; border-radius:999px; text-decoration:none;
      font-size:13px; font-weight:600; color:#1d4ed8;
      background:rgba(37,99,235,.08); border:1px solid rgba(37,99,235,.25);
      white-space:nowrap;
    }
    .muted { color:#6b7280; font-size:13px; }
    .embedStatus{
      display:flex; align-items:center; gap:10px;
      padding:8px 10px; border:1px solid #e5e7eb; border-radius:10px;
      background:#fafafa; margin: 10px 0 12px; font-size:12.5px; color:#334155;
    }
    .badge{ margin-left:auto; display:inline-flex; align-items:center; gap:8px; padding:4px 8px; border-radius:999px; border:1px solid #e5e7eb; background:#fff; color:#64748b; font-weight:800; }
    .dot{ width:8px; height:8px; border-radius:999px; background:#94a3b8; }
    .container{ border:1px solid #eef0f3; border-radius:12px; padding:12px; min-height:240px; background:#fff; }
  </style>
</head>
<body>
  <main class="wrap">
    <a href="./index.html" class="back-btn">‚Üê Volver al selector</a>

    <div class="card">
      <h1>Embedded Form (standalone)</h1>
      <p class="muted">P√°gina dedicada a renderizar el embedded form en un contenedor.</p>

      <div class="embedStatus">
        <strong>Estado:</strong> <span id="msg">Iniciando‚Ä¶</span>
        <span class="badge"><span class="dot" id="dot"></span><span id="state">IDLE</span></span>
      </div>

      <div id="ucpm-embedded-form" class="container"></div>
    </div>
  </main>

<script>
(function(){
  // üîÅ CAMBIA ESTOS 3 VALORES
  const EMBED_SCRIPT_SRC = "https://privacyportaltrial.onetrust.com/consent-embedded-forms/consent-receipt-scripts/OtFormStub.js";
  const EMBED_COLLECTION_POINT_ID = "86cfa775-f542-42b6-8f6d-30a22fc81ba1";
  const EMBED_WORKER = "https://consent-api.onetrust.com";

  const msg = document.getElementById("msg");
  const dot = document.getElementById("dot");
  const state = document.getElementById("state");
  const container = document.getElementById("ucpm-embedded-form");

  function setStatus(s, m){
    state.textContent = s.toUpperCase();
    msg.textContent = m || "";
    dot.style.background = (s==="loading") ? "#f59e0b" : (s==="ok") ? "#22c55e" : (s==="error") ? "#ef4444" : "#94a3b8";
  }

  function load(){
    setStatus("loading","Cargando script‚Ä¶");
    container.innerHTML = "";

    const prev = document.getElementById("ot-embed-script");
    if (prev) prev.remove();

    const sc = document.createElement("script");
    sc.id = "ot-embed-script";
    sc.src = EMBED_SCRIPT_SRC;
    sc.async = true;
    sc.setAttribute("data-id", EMBED_COLLECTION_POINT_ID);
    sc.setAttribute("worker", EMBED_WORKER);

    sc.onload = () => {
      setStatus("ok","Script cargado. Si no pinta, revisa Console/Network.");
      console.log("OT embedded globals:", {
        OtFormStub: window.OtFormStub,
        OneTrust: window.OneTrust,
        Onetrust: window.Onetrust,
        __OT__: window.__OT__
      });
    };
    sc.onerror = () => setStatus("error","No se pudo cargar el script (bloqueo/red).");

    container.insertAdjacentElement("afterend", sc);
  }

  window.addEventListener("load", load);
})();
</script>
</body>
</html>
