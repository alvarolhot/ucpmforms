<!-- external.html (HTML + SDK) -->
<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>External Web Form (HTML + SDK)</title>

  <style>
    :root { font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif; }
    body { margin:0; background:#f6f7f9; color:#0f172a; }
    .wrap { max-width: 980px; margin: 0 auto; padding: 24px; }

    .top { display:flex; justify-content:space-between; align-items:flex-start; gap: 12px; margin-bottom: 14px; }
    .brand { display:flex; flex-direction:column; gap: 6px; }
    .brand h1 { margin:0; font-size: 20px; letter-spacing: -0.02em; }
    .brand p { margin:0; color:#64748b; font-size: 13px; line-height: 1.35; }

    .back-btn {
      display:inline-flex; align-items:center; gap: 8px;
      padding: 8px 14px; border-radius: 999px;
      text-decoration:none; font-size: 13px; font-weight: 800;
      color:#1d4ed8; background: rgba(37,99,235,.08);
      border: 1px solid rgba(37,99,235,.25); white-space: nowrap;
    }

    .card {
      background:#fff; border-radius: 14px; padding: 18px; margin: 14px 0;
      box-shadow: 0 2px 10px rgba(0,0,0,.06); border: 1px solid #eef0f3;
    }

    .hint {
      margin-top: 10px; font-size: 13px; color:#64748b; line-height: 1.35;
    }

    /* === OneTrust form styling (your generated CSS, slightly aligned) === */
    .ot-form-consent { max-width: 520px; padding: 10px 0; margin: 0 auto; }
    .ot-form-consent label { display:block; font-size: 13px; font-weight: 800; margin: 10px 0 6px; color:#0f172a; }
    .ot-form-control {
      position: relative; height: auto; padding: 10px 12px; font-size: 14px;
      margin-bottom: 12px; display: block; width: 100%; line-height: 1.25;
      border: 1px solid rgba(15, 23, 42, 0.15); border-radius: 10px;
      background:#fff;
    }
    .ot-checkbox { margin-top: 10px; }
    .ot-checkbox label { font-weight: 600; color:#334155; display:flex; gap:10px; align-items:flex-start; }
    .ot-submit-button {
      display: inline-flex; justify-content:center; align-items:center;
      padding: 10px 14px; font-size: 14px; font-weight: 900;
      border-radius: 10px; color: #fff;
      background-color: #2563eb; border: 1px solid rgba(37,99,235,.35);
      margin-top: 14px; cursor:pointer; width: 100%;
    }
    .ot-submit-button:hover { filter: brightness(0.97); }

    .status {
      max-width: 520px; margin: 10px auto 0;
      padding: 10px 12px; border-radius: 12px;
      border: 1px solid #e5e7eb; background:#fafafa;
      font-size: 12.5px; color:#334155; line-height: 1.35;
    }
    .mono { font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace; }

    @media (max-width: 760px) { .wrap { padding: 18px; } }
  </style>
</head>

<body>
  <main class="wrap">
    <div class="top">
      <div class="brand">
        <h1>2) External Web Form (HTML + SDK)</h1>
        <p>This page uses the OneTrust-generated HTML + SDK. The key fix is preventing the browser from navigating on submit (otherwise GitHub Pages returns 403).</p>
      </div>
      <a class="back-btn" href="./index.html">← Back to selector</a>
    </div>

    <section class="card">

      <!-- ✅ Your generated form (with small fixes: name attributes + no navigation) -->
      <form class="ot-form-consent" action="#" method="post" data-ot-cp-id="299d23f4-cdd2-4fc2-9009-9ed75b7719d6-active" id="otExternalForm">
        <input type="hidden" id="confirmation" name="receiptId" value="" />

        <label for="inputEmail">Email</label>
        <input type="email" id="inputEmail" name="Email" class="ot-form-control" placeholder="Email" required>

        <label for="Mobile">Mobile</label>
        <input type="text" id="Mobile" name="Mobile" class="ot-form-control" placeholder="Mobile">

        <label for="FirstName">First Name</label>
        <input type="text" id="FirstName" name="FirstName" class="ot-form-control" placeholder="First Name">

        <label for="LastName">Last Name</label>
        <input type="text" id="LastName" name="LastName" class="ot-form-control" placeholder="Last Name">

        <div class="ot-checkbox">
          <label>
            <input value="Marketing Email Communications" name="purpose_marketing" type="checkbox">
            Marketing Email Communications
          </label>
        </div>

        <div class="ot-checkbox">
          <label>
            <input value="Profiling" name="purpose_profiling" type="checkbox">
            Profiling
          </label>
        </div>

        <button id="trigger" class="ot-submit-button" type="submit">Submit form</button>
      </form>

      <div class="status" id="statusBox">
        <strong>Status:</strong> Ready. Open DevTools → <span class="mono">Network</span> and filter for “consent” / “receipt”. If OneTrust SDK is working, you should see XHR calls on submit.
      </div>

      <div class="hint">
        If the SDK is loaded but nothing is sent, check: adblockers, blocked third-party scripts, or collection point domain/origin restrictions.
      </div>

      <!-- ✅ OneTrust SDK script (as provided) -->
      <script
        src="https://privacyportaltrial-cdn.onetrust.com/consent-receipt-scripts/scripts/otconsent-1.0.min.js"
        type="text/javascript"
        data-ot-id="86cfa775-f542-42b6-8f6d-30a22fc81ba1"
        charset="UTF-8"
        id="consent-receipt-script"
        data-ot-consent-register-event="document-load"
      ></script>

      <script>
        (function () {
          const form = document.getElementById("otExternalForm");
          const statusBox = document.getElementById("statusBox");

          // ✅ CRITICAL FIX:
          // Prevent the default browser POST navigation (GitHub Pages returns 403),
          // but DO NOT stop propagation — OneTrust can still listen to submit and send XHR.
          form.addEventListener("submit", function (e) {
            e.preventDefault();

            statusBox.innerHTML =
              "<strong>Status:</strong> Submit intercepted (no page navigation). " +
              "If SDK is active, it should send the receipt via XHR. Check DevTools → <span class='mono'>Network</span>.";
          });

          // Optional: show whether the script actually loaded
          window.addEventListener("load", () => {
            const script = document.getElementById("consent-receipt-script");
            if (!script) return;

            setTimeout(() => {
              statusBox.innerHTML =
                "<strong>Status:</strong> Page loaded. SDK script tag present. " +
                "Click <span class='mono'>Submit form</span> and check Network for XHR calls.";
            }, 300);
          });
        })();
      </script>

    </section>
  </main>
</body>
</html>
