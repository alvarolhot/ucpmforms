<!-- external.html (fix 405 + CP active) -->
<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>UCPM Demo – External Web Form</title>

  <style>
    :root { font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif; }
    body { margin: 0; background: #f6f7f9; }
    .wrap { max-width: 980px; margin: 0 auto; padding: 24px; }
    .card { background: #fff; border-radius: 12px; padding: 18px; margin: 18px 0; box-shadow: 0 2px 10px rgba(0,0,0,.06); }
    .muted { color:#6b7280; font-size: 13px; }

    .back-bar { margin-bottom: 14px; }
    .back-btn {
      display: inline-flex; align-items: center; gap: 8px;
      padding: 8px 14px;
      border-radius: 999px;
      text-decoration: none;
      font-size: 13px;
      font-weight: 600;
      color: #1d4ed8;
      background: rgba(37,99,235,.08);
      border: 1px solid rgba(37,99,235,.25);
      transition: all .15s ease;
    }
    .back-btn:hover { background: rgba(37,99,235,.15); }
  </style>

  <style>
    .ot-form-consent { max-width: 720px; margin: 0 auto; padding: 10px 6px; }
    .ot-form-title { margin: 0 0 12px; font-size: 16px; font-weight: 800; letter-spacing: -0.01em; color: #0f172a; }
    .ot-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 14px; margin: 12px 0 8px; }
    .ot-field { display: grid; gap: 6px; }

    .ot-form-consent label { display: block; font-size: 13px; font-weight: 700; color: #0f172a; }
    .ot-form-control {
      width: 100%;
      padding: 11px 12px;
      border: 1px solid #d7dbe0;
      border-radius: 10px;
      font-size: 14px;
      outline: none;
      background: #fff;
      transition: border-color .15s ease, box-shadow .15s ease;
    }
    .ot-form-control:focus { border-color: rgba(37,99,235,.65); box-shadow: 0 0 0 4px rgba(37,99,235,.12); }

    .ot-checkboxes {
      margin-top: 8px;
      display: grid;
      gap: 10px;
      padding: 12px;
      border: 1px solid #eef0f3;
      border-radius: 12px;
      background: #fafafa;
    }
    .ot-checkboxes label {
      display: flex;
      align-items: center;
      gap: 10px;
      font-weight: 600;
      font-size: 13px;
      color: #111827;
      margin: 0;
    }
    .ot-checkboxes input[type="checkbox"]{ width: 18px; height: 18px; margin: 0; accent-color: #2563eb; }

    .ot-submit-button {
      display: inline-flex;
      align-items: center;
      justify-content: center;
      width: 100%;
      margin-top: 14px;
      padding: 12px 16px;
      font-size: 15px;
      font-weight: 800;
      border-radius: 12px;
      color: #fff;
      background: #2563eb;
      border: 1px solid #2563eb;
      cursor: pointer;
      transition: transform .05s ease, background .15s ease, border-color .15s ease;
    }
    .ot-submit-button:hover { background: #1d4ed8; border-color: #1d4ed8; }
    .ot-submit-button:active { transform: translateY(1px); }

    .debug-box{
      margin-top: 10px;
      border: 1px dashed #d7dbe0;
      border-radius: 12px;
      padding: 12px;
      background: #fafafa;
      font-size: 12px;
      color: #374151;
      white-space: pre-wrap;
      word-break: break-word;
    }

    @media (max-width: 720px) {
      .ot-grid { grid-template-columns: 1fr; }
      .ot-form-consent { max-width: 520px; }
    }
  </style>
</head>

<body>
  <main class="wrap">
    <div class="back-bar">
      <a href="./index.html" class="back-btn">← Volver al selector</a>
    </div>

    <h1>External Web Form (HTML + SDK)</h1>
    <p class="muted">Este formulario lo renderizas tú (HTML) y OneTrust gestiona el envío del receipt vía su SDK.</p>

    <section class="card">
      <!-- ✅ IMPORTANTE: action no puede postear a GitHub Pages -->
      <form class="ot-form-consent"
            action="javascript:void(0)"
            method="post"
            data-ot-cp-id="299d23f4-cdd2-4fc2-9009-9ed75b7719d6-active"
            id="otExternalForm">

        <p class="ot-form-title">Lead capture</p>

        <input type="hidden" id="confirmation" name="receiptId" value="" />

        <div class="ot-grid">
          <div class="ot-field">
            <label for="inputEmail">Email</label>
            <input type="email" id="inputEmail" name="Email" class="ot-form-control" placeholder="name@company.com" required>
          </div>

          <div class="ot-field">
            <label for="Mobile">Mobile</label>
            <input type="text" id="Mobile" name="Mobile" class="ot-form-control" placeholder="+34...">
          </div>
        </div>

        <div class="ot-grid">
          <div class="ot-field">
            <label for="FirstName">First name</label>
            <input type="text" id="FirstName" name="FirstName" class="ot-form-control" placeholder="Alvaro">
          </div>

          <div class="ot-field">
            <label for="LastName">Last name</label>
            <input type="text" id="LastName" name="LastName" class="ot-form-control" placeholder="Lopez">
          </div>
        </div>

        <div class="ot-checkboxes">
          <label>
            <input value="Marketing Email Communications" type="checkbox" name="purposes">
            Marketing Email Communications
          </label>

          <label>
            <input value="Profiling" type="checkbox" name="purposes">
            Profiling
          </label>
        </div>

        <button id="trigger" class="ot-submit-button" type="submit">Submit</button>

        <div id="debug" class="debug-box">Debug: listo. Abre Network y filtra por "consentreceipts".</div>
      </form>

      <script
        src="https://privacyportaltrial-cdn.onetrust.com/consent-receipt-scripts/scripts/otconsent-1.0.min.js"
        type="text/javascript"
        data-ot-id="86cfa775-f542-42b6-8f6d-30a22fc81ba1"
        charset="UTF-8"
        id="consent-receipt-script"
        data-ot-consent-register-event="document-load"
      ></script>
    </section>
  </main>

  <script>
    // ✅ Evita el POST nativo a GitHub Pages (causante del 405)
    const f = document.getElementById("otExternalForm");
    const debug = document.getElementById("debug");

    f.addEventListener("submit", function(e){
      e.preventDefault();
      debug.textContent =
        "Submit capturado (sin POST a GitHub). " +
        "Si el SDK está integrado, deberías ver una llamada en Network → consentreceipts.\n\n" +
        "Si NO ves llamada: revisa que data-ot-cp-id sea el '-active' correcto y que el tenant (data-ot-id) sea el tuyo.";
    });

    // (Opcional) Log de click
    document.getElementById("trigger").addEventListener("click", () => {
      debug.textContent = "Click en Submit. Revisa Network → consentreceipts…";
    });
  </script>
</body>
</html>
